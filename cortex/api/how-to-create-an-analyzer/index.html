
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://thehive-project.github.io/docs/cortex/api/how-to-create-an-analyzer/">
      
      
        <link rel="prev" href="../how-to-create-a-responder/">
      
      
        <link rel="next" href="../../download/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.3.1">
    
    
      
        <title>How to Write and Submit an Analyzer - TheHive Project Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#how-to-write-and-submit-an-analyzer" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
             
This documentation site is deprecated. Please visit <a href=https://docs.strangebe.com><b>https://docs.strangebee.com</b></a> for <a href=https://docs.strangebee.com/thehive/setup/><b>TheHive 5</b></a> and <a href=https://docs.strangebee.com/cortex><b>Cortex</b></a> documentation ! 
 
          </div>
          
        </aside>
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="TheHive Project Documentation" class="md-header__button md-logo" aria-label="TheHive Project Documentation" data-md-component="logo">
      
  <img src="../../../images/thehive.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TheHive Project Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              How to Write and Submit an Analyzer
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../thehive/" class="md-tabs__link">
          
  
    
  
  TheHive 4

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="https://docs.strangebee.com/thehive/setup/" class="md-tabs__link">
        
  
    
  
  TheHive 5

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="TheHive Project Documentation" class="md-nav__button md-logo" aria-label="TheHive Project Documentation" data-md-component="logo">
      
  <img src="../../../images/thehive.png" alt="logo">

    </a>
    TheHive Project Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../thehive/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    TheHive 4
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            TheHive 4
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../thehive/installation-and-configuration/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Installation and configuration
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Installation and configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_2" >
        
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/installation/step-by-step-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step by step guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/installation/build-sources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build sources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_3" >
        
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/configuration/secret/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secret key
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/configuration/service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/configuration/ssl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/configuration/proxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/configuration/database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database & indexes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/configuration/file-storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/configuration/akka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/configuration/authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/configuration/connectors-cortex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cortex connector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/configuration/connectors-misp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MISP connector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/configuration/webhooks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Webhooks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/configuration/logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/configuration/manage-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2_4" >
        
          <label class="md-nav__link" for="__nav_2_2_4" id="__nav_2_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/installation-and-configuration/architecture/3_nodes_cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use TheHive as a cluster
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../thehive/user-guides/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    User guides
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            User guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/quick-start/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick start with TheHive
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3_3" >
        
          <label class="md-nav__link" for="__nav_2_3_3" id="__nav_2_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Administrators
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_3">
            <span class="md-nav__icon md-icon"></span>
            Administrators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/administrators/analyzer-templates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage analyzer template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/administrators/custom-fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage custom fields
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/administrators/observable-types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage observable types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/administrators/organisations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Organisations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/administrators/plateform-status/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plateform status
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/administrators/profiles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Profiles management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/administrators/tactics-techniques-procedures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tactics, Techniques & Procedures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/administrators/tags-and-taxonomies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Taxonomies and Tags
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3_4" >
        
          <label class="md-nav__link" for="__nav_2_3_4" id="__nav_2_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Organisation managers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_4">
            <span class="md-nav__icon md-icon"></span>
            Organisation managers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/organisation-managers/case-templates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Case Templates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/organisation-managers/custom-tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom Tags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/organisation-managers/organisations-users-sharing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Organisations, Users and sharing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/organisation-managers/ui-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UI configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/organisation-managers/users-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Users management
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3_5" >
        
          <label class="md-nav__link" for="__nav_2_3_5" id="__nav_2_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Analysts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_5">
            <span class="md-nav__icon md-icon"></span>
            Analysts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/analysts/create-alerts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Alerts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/analysts/create-case/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Cases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/analysts/create-tasks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage Case Tasks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/analysts/create-observables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create Case Observables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/analysts/ttps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tactics, Techniques and Procedures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/analysts/run-responders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run Responders
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/analysts/run-analyzers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run Analyzers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/analysts/sharing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sharing Cases, Tasks and Observables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/analysts/close-case/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Close Cases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/analysts/export-case/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Export Cases to MISP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/user-guides/analysts/user-settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User settings configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Operations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/operations/update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Howto update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/operations/migration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migration from TheHive 3.x
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/operations/backup-restore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backup & restore
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/operations/https/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure HTTPS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/operations/fail2ban/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use fail2ban
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/operations/cassandra-security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cassandra & security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/operations/troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../thehive/api/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    APIs
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2_5">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            APIs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../thehive/api/organisation/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Organisation
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2_5_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_2">
            <span class="md-nav__icon md-icon"></span>
            Organisation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/organisation/create/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/organisation/update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/organisation/list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List/Search
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/organisation/list-links/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List links
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../thehive/api/user/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    User
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2_5_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_3">
            <span class="md-nav__icon md-icon"></span>
            User
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/user/list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/user/create/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/user/update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/user/set-password/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Set password
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/user/generate-api-key/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate API key
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/user/revoke-api-key/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Revoke API key
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/user/get-api-key/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get API key
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/user/lock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lock / Unlock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/user/delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../thehive/api/custom-field/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Custom field
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2_5_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_4">
            <span class="md-nav__icon md-icon"></span>
            Custom field
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/custom-field/list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/custom-field/create/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/custom-field/update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/custom-field/delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/custom-field/get/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/custom-field/getUse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use count
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../thehive/api/case-template/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Case template
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2_5_5">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_5">
            <span class="md-nav__icon md-icon"></span>
            Case template
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/case-template/list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get / List
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/case-template/create/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/case-template/update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/case-template/delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../thehive/api/alert/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Alert
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2_5_6">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_6">
            <span class="md-nav__icon md-icon"></span>
            Alert
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/alert/list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List / Search
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/alert/create/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/alert/update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/alert/read/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mark as Read/Unread
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/alert/delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/alert/promote-as-case/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Promote
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/alert/merge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Merge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/alert/similar-cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List similar Cases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/alert/list-observables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List Observables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/alert/add-observable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add observables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/alert/update-observable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update observable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/alert/delete-observable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add observables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/alert/run-responder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run Responder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/alert/list-responder-jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List responder actions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../thehive/api/case/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Case
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2_5_7">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_7">
            <span class="md-nav__icon md-icon"></span>
            Case
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/case/create/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/case/update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/case/delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/case/merge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Merge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/case/export/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Export Case to MISP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/case/related-cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List related Cases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/case/related-alerts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List related Alerts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/case/attachments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List related Alerts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/case/run-responder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run responder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/case/responder-jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List responder actions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../thehive/api/task/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Task
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2_5_8">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_8">
            <span class="md-nav__icon md-icon"></span>
            Task
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/task/create/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/task/update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/task/get/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get case task
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/task/list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List case tasks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/task/run-responder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run responder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/task/responder-jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List responder jobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/task/create-log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add log
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/task/delete-log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete log
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/task/log-run-responder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run responder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/task/log-responder-jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List responder jobs on log
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/task/logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List task logs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/task/waiting-tasks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List waiting tasks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../thehive/api/observable/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Observable
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_2_5_9">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5_9">
            <span class="md-nav__icon md-icon"></span>
            Observable
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/observable/create/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/observable/update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/observable/delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delete
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/observable/list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List / Search
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/observable/analyzer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analyzer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../thehive/api/observable/responder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Responder
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.strangebee.com/thehive/setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TheHive 5
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    Table of Contents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#writing-an-analyzer" class="md-nav__link">
    Writing an Analyzer
  </a>
  
    <nav class="md-nav" aria-label="Writing an Analyzer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-program" class="md-nav__link">
    The Program
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-interaction-files-flavors" class="md-nav__link">
    Service Interaction Files (Flavors)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-requirements" class="md-nav__link">
    Python Requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-virustotal-analyzer-files" class="md-nav__link">
    Example: VirusTotal Analyzer Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#input" class="md-nav__link">
    Input
  </a>
  
    <nav class="md-nav" aria-label="Input">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-virustotal-get-reports-input" class="md-nav__link">
    Example: VirusTotal Get Report's Input
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-service-interaction-file-for-virustotal-getreport" class="md-nav__link">
    Example: Service Interaction File for VirusTotal GetReport
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-interaction-configuration-items" class="md-nav__link">
    Service Interaction Configuration Items
  </a>
  
    <nav class="md-nav" aria-label="Service Interaction Configuration Items">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#version" class="md-nav__link">
    version
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#author" class="md-nav__link">
    author
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url" class="md-nav__link">
    url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#license" class="md-nav__link">
    license
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#description" class="md-nav__link">
    description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#datatypelist" class="md-nav__link">
    dataTypeList
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#baseconfig" class="md-nav__link">
    baseConfig
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#config" class="md-nav__link">
    config
  </a>
  
    <nav class="md-nav" aria-label="config">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#max_tlp" class="md-nav__link">
    max_tlp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check_tlp" class="md-nav__link">
    check_tlp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max_pap" class="md-nav__link">
    max_pap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check_pap" class="md-nav__link">
    check_pap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command" class="md-nav__link">
    command
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configurationitems" class="md-nav__link">
    configurationItems
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-cortexutils-python-library" class="md-nav__link">
    The Cortexutils Python Library
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#report-templates" class="md-nav__link">
    Report Templates
  </a>
  
    <nav class="md-nav" aria-label="Report Templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cortex-result-in-thehive" class="md-nav__link">
    Cortex Result in TheHive
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#displayed-information" class="md-nav__link">
    Displayed Information
  </a>
  
    <nav class="md-nav" aria-label="Displayed Information">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#when-no-template-is-imported" class="md-nav__link">
    When No Template is Imported
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-templates-are-imported" class="md-nav__link">
    When Templates are Imported
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writing-templates" class="md-nav__link">
    Writing Templates
  </a>
  
    <nav class="md-nav" aria-label="Writing Templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#short-report-templates-shorthtml" class="md-nav__link">
    Short Report Templates (short.html)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#long-report-templates-longhtml" class="md-nav__link">
    Long Report Templates (long.html)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#submitting-an-analyzer" class="md-nav__link">
    Submitting an Analyzer
  </a>
  
    <nav class="md-nav" aria-label="Submitting an Analyzer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-existing-issues" class="md-nav__link">
    Check Existing Issues
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#open-an-issue" class="md-nav__link">
    Open an Issue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#review-your-service-interaction-files" class="md-nav__link">
    Review your Service Interaction File(s)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#provide-the-list-of-requirements" class="md-nav__link">
    Provide the List of Requirements
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-the-taxonomy" class="md-nav__link">
    Check the Taxonomy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#provide-global-configuration-parameters" class="md-nav__link">
    Provide Global Configuration Parameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-execution" class="md-nav__link">
    Verify Execution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-pull-request" class="md-nav__link">
    Create a Pull Request
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#need-help" class="md-nav__link">
    Need Help?
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="how-to-write-and-submit-an-analyzer">How to Write and Submit an Analyzer<a class="headerlink" href="#how-to-write-and-submit-an-analyzer" title="Permanent link">#</a></h1>
<h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">#</a></h2>
<ul>
<li><a href="#writing-an-analyzer">Writing an Analyzer</a><ul>
<li><a href="#the-program">The Program</a></li>
<li><a href="#service-interaction-files-flavors">Service Interaction Files (Flavors)</a></li>
<li><a href="#python-requirements">Python Requirements</a></li>
<li><a href="#example-virustotal-analyzer-files">Example: VirusTotal Analyzer Files</a></li>
<li><a href="#input">Input</a></li>
<li><a href="#service-interaction-configuration-items">Service Interaction Configuration Items</a></li>
<li><a href="#analyzer-configuration-in-the-global-configuration-file">Analyzer Configuration in the Global Configuration File</a></li>
<li><a href="#output">Output</a></li>
<li><a href="#the-cortexutils-python-library">The Cortexutils Python Library</a></li>
<li><a href="#report-templates">Report Templates</a></li>
</ul>
</li>
<li><a href="#submitting-an-analyzer">Submitting an Analyzer</a><ul>
<li><a href="#check-existing-issues">Check Existing Issues</a></li>
<li><a href="#open-an-issue">Open an Issue</a></li>
<li><a href="#review-your-service-interaction-files">Review your Service Interaction File(s)</a></li>
<li><a href="#provide-the-list-of-requirements">Provide the List of Requirements</a></li>
<li><a href="#check-the-taxonomy">Check the Taxonomy</a></li>
<li><a href="#provide-global-configuration-parameters">Provide Global Configuration Parameters</a></li>
<li><a href="#verify-execution">Verify Execution</a></li>
<li><a href="#create-a-pull-request">Create a Pull Request</a></li>
</ul>
</li>
<li><a href="#need-help">Need Help?</a></li>
</ul>
<h2 id="writing-an-analyzer">Writing an Analyzer<a class="headerlink" href="#writing-an-analyzer" title="Permanent link">#</a></h2>
<p>An analyzer is a program that takes an observable and
configuration information as <strong>raw input</strong>, analyze the observable and
produces a result as <strong>raw output</strong>. It is made of at least 2 types of files:</p>
<ul>
<li>The program itself</li>
<li>One or several service interaction files or flavors</li>
<li>A Python requirements file, which is only necessary if the analyzer is
written in Python.</li>
</ul>
<h3 id="the-program">The Program<a class="headerlink" href="#the-program" title="Permanent link">#</a></h3>
<p>The first type of files an analyzer is made of is the core program that
performs actions. It can be written in any programming
language that is supported by Linux.</p>
<p>While many analyzers are written in Python (<code>*.py</code> files), you can write yours
in Ruby, Perl or even Scala. However, the very handy <code>Cortexutils</code> library
<a href="#the-cortexutils-python-library">described below</a> is in Python. It greatly facilitates analyzer development and
it also provides some methods to quickly format the output to make it compliant
with the JSON schema expected by <a href="https://github.com/TheHive-Project/TheHive/">TheHive</a>.</p>
<h3 id="service-interaction-files-flavors">Service Interaction Files (Flavors)<a class="headerlink" href="#service-interaction-files-flavors" title="Permanent link">#</a></h3>
<p>An analyzer must have at least one service interaction file. Such files
contain key configuration information such as the analyzer's author
information, the datatypes (IP, URL, hash, domain...) the analyzer accepts as
input, the TLP and PAP (<a href="https://www.misp-project.org/taxonomies.html#_pap">Permissible Actions Protocol</a>) above which it will refuse to execute to protect against data leakage and to enforce sane OPSEC practices and so on.</p>
<p>An analyzer can have two or more service interaction files to allow it to
perform different actions.  We speak then of flavors. For example, a sandbox analyzer can analyze a file with or without an
Internet connection. Another example could be an analyzer that can either
send a file to VirusTotal for analysis or get the last report using its hash.</p>
<h3 id="python-requirements">Python Requirements<a class="headerlink" href="#python-requirements" title="Permanent link">#</a></h3>
<p>If the analyzer is written in Python, a <code>requirements.txt</code> must be provided
with the list of all the dependencies.</p>
<h3 id="example-virustotal-analyzer-files">Example: VirusTotal Analyzer Files<a class="headerlink" href="#example-virustotal-analyzer-files" title="Permanent link">#</a></h3>
<p>Below is a directory listing of the files corresponding to the VirusTotal
analyzer. You can see that the analyzer has two flavors: <strong>GetReport</strong> and
<strong>Scan</strong>.</p>
<div class="highlight"><pre><span></span><code>analyzers/VirusTotal
<span class="p">|</span>--<span class="w"> </span>VirusTotal_GetReport.json
<span class="p">|</span>--<span class="w"> </span>VirusTotal_Scan.json
<span class="p">|</span>--<span class="w"> </span>requirements.txt
<span class="p">|</span>--<span class="w"> </span>virustotal.py
<span class="sb">`</span>--<span class="w"> </span>virustotal_api.py
</code></pre></div>
<h3 id="input">Input<a class="headerlink" href="#input" title="Permanent link">#</a></h3>
<p>The input of an analyzer is a JSON structure with different
pieces of information. For example, to use the VirusTotal analyzer's
<strong>GetReport</strong> flavor in order to obtain the latest available report for hash
<code>d41d8cd98f00b204e9800998ecf8427e</code>, you must submit input such as:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="s2">&quot;d41d8cd98f00b204e9800998ecf8427e&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;dataType&quot;</span><span class="p">:</span><span class="s2">&quot;hash&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tlp&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:{</span>
<span class="w">        </span><span class="nt">&quot;key&quot;</span><span class="p">:</span><span class="s2">&quot;1234567890abcdef&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;max_tlp&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;check_tlp&quot;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;service&quot;</span><span class="p">:</span><span class="s2">&quot;GetReport&quot;</span>
<span class="w">        </span><span class="p">[</span><span class="err">..</span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;proxy&quot;</span><span class="p">:{</span>
<span class="w">        </span><span class="nt">&quot;http&quot;</span><span class="p">:</span><span class="s2">&quot;http://myproxy:8080&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;https&quot;</span><span class="p">:</span><span class="s2">&quot;https://myproxy:8080&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
</code></pre></div>
<p><code>data</code>, <code>dataType</code> and <code>tlp</code> are the observable-related information generated by
TheHive or any other program that is calling Cortex. <code>config</code> is the
analyzer's specific configuration provided by an <code>orgAdmin</code> users when the analyzer is enabled in the Cortex UI.</p>
<p>Let's take the <strong>GetReport</strong> flavor of the VirusTotal analyzer as an
example again.</p>
<h4 id="example-virustotal-get-reports-input">Example: VirusTotal Get Report's Input<a class="headerlink" href="#example-virustotal-get-reports-input" title="Permanent link">#</a></h4>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="s2">&quot;d41d8cd98f00b204e9800998ecf8427e&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;dataType&quot;</span><span class="p">:</span><span class="s2">&quot;hash&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tlp&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="p">[</span><span class="err">..</span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
</code></pre></div>
<h4 id="example-service-interaction-file-for-virustotal-getreport">Example: Service Interaction File for VirusTotal GetReport<a class="headerlink" href="#example-service-interaction-file-for-virustotal-getreport" title="Permanent link">#</a></h4>
<p>The <code>&lt;==</code> sign and anything after it are comments that do no appear in the
original file.
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VirusTotal_GetReport&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3.0&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;author&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CERT-BDF&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://github.com/TheHive-Project/Cortex-Analyzers&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;license&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AGPL-V3&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Get the latest VirusTotal report for a file, hash, domain or an IP address.&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;dataTypeList&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;hash&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;domain&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ip&quot;</span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VirusTotal/virustotal.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">&lt;==</span><span class="w"> </span><span class="err">Program</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="w"> </span><span class="err">ru</span><span class="kc">n</span><span class="w"> </span><span class="err">whe</span><span class="kc">n</span><span class="w"> </span><span class="err">i</span><span class="kc">n</span><span class="err">voki</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="err">a</span><span class="kc">nal</span><span class="err">yzer</span>
<span class="w">  </span><span class="nt">&quot;baseConfig&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VirusTotal&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">&lt;==</span><span class="w"> </span><span class="kc">na</span><span class="err">me</span><span class="w"> </span><span class="err">o</span><span class="kc">f</span><span class="w"> </span><span class="err">base</span><span class="w"> </span><span class="err">co</span><span class="kc">nf</span><span class="err">ig</span><span class="w"> </span><span class="err">i</span><span class="kc">n</span><span class="w"> </span><span class="err">Cor</span><span class="kc">te</span><span class="err">x</span><span class="w"> </span><span class="err">a</span><span class="kc">nal</span><span class="err">yzer</span><span class="w"> </span><span class="err">co</span><span class="kc">nf</span><span class="err">ig</span><span class="w"> </span><span class="err">page</span>
<span class="w">  </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;service&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;get&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;configurationItems&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">&lt;==</span><span class="w"> </span><span class="err">lis</span><span class="kc">t</span><span class="w"> </span><span class="err">o</span><span class="kc">f</span><span class="w"> </span><span class="err">co</span><span class="kc">nf</span><span class="err">igura</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">ms</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="err">a</span><span class="kc">nal</span><span class="err">yzer</span><span class="w"> </span><span class="kc">nee</span><span class="err">ds</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="w"> </span><span class="err">opera</span><span class="kc">te</span><span class="w"> </span><span class="err">(api</span><span class="w"> </span><span class="err">key</span><span class="w"> </span><span class="err">e</span><span class="kc">t</span><span class="err">c.)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;key&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;API key for Virustotal&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="w"> </span><span class="err">&lt;==</span><span class="w"> </span><span class="err">de</span><span class="kc">f</span><span class="err">i</span><span class="kc">nes</span><span class="w"> </span><span class="err">wha</span><span class="kc">t</span><span class="w"> </span><span class="err">ki</span><span class="kc">n</span><span class="err">d</span><span class="w"> </span><span class="err">o</span><span class="kc">f</span><span class="w"> </span><span class="err">da</span><span class="kc">ta</span><span class="w"> </span><span class="kc">t</span><span class="err">ype</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="err">co</span><span class="kc">nf</span><span class="err">igura</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">m</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">(s</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g</span><span class="p">,</span><span class="w"> </span><span class="kc">nu</span><span class="err">mber)</span>
<span class="w">      </span><span class="nt">&quot;multi&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="err">&lt;==</span><span class="w"> </span><span class="err">se</span><span class="kc">tt</span><span class="err">i</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="err">mul</span><span class="kc">t</span><span class="err">i</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="err">allows</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="w"> </span><span class="err">pass</span><span class="w"> </span><span class="err">a</span><span class="w"> </span><span class="err">lis</span><span class="kc">t</span><span class="w"> </span><span class="err">o</span><span class="kc">f</span><span class="w"> </span><span class="err">i</span><span class="kc">te</span><span class="err">ms</span><span class="w"> </span><span class="err">(e.g.</span><span class="w"> </span><span class="err">MISP</span><span class="w"> </span><span class="err">a</span><span class="kc">nal</span><span class="err">yzer)</span>
<span class="w">      </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;polling_interval&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Define time interval between two requests attempts for the report&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;multi&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></p>
<h3 id="service-interaction-configuration-items">Service Interaction Configuration Items<a class="headerlink" href="#service-interaction-configuration-items" title="Permanent link">#</a></h3>
<h4 id="name">name<a class="headerlink" href="#name" title="Permanent link">#</a></h4>
<p>Name of the specific service (or flavor) of the analyzer.</p>
<p>If your analyzer has only one service interaction (i.e. performs only one
action), it is the name of the analyzer's directory.</p>
<p>If your analyzer performs several actions (i.e. comes in several flavors),
you have to give a specific and meaningful name to each flavor.</p>
<p>Each flavor's name appear in TheHive's analyzer list and in MISP when you
use Cortex for attribute enrichment.</p>
<h4 id="version">version<a class="headerlink" href="#version" title="Permanent link">#</a></h4>
<p>The version of the analyzer.</p>
<p>You <strong>must</strong> increase major version numbers when new features are added,
modifications are made to take into account API changes, report output is
modified or when report templates (more on this later) are updated.</p>
<p>You must increase minor version numbers when bugs are fixed.</p>
<p>The version number is also used in the folder name of the associated report
templates ; e.g. <em>VirusTotal_GetReport</em> and <em>3.0</em> on the JSON file should
correspond a folder named <em>VirusTotal_GetReport_3_0</em> for report templates.
 Report templates are used by TheHive to display the analyzer's JSON output
 in an analyst-friendly fashion.</p>
<h4 id="author">author<a class="headerlink" href="#author" title="Permanent link">#</a></h4>
<p>You must provide your full name and/or your organization/team name when
submitting an analyzer. Pseudos are not accepted. If you'd rather remain
anonymous, please contact us at support@thehive-project.org prior to
submitting your analyzer.</p>
<h4 id="url">url<a class="headerlink" href="#url" title="Permanent link">#</a></h4>
<p>The URL where the analyzer is stored. This should ideally be
<code>https://github.com/TheHive-Project/Cortex-Analyzers</code></p>
<h4 id="license">license<a class="headerlink" href="#license" title="Permanent link">#</a></h4>
<p>The license of the code. Ideally, we recommend using the AGPL-v3
license.</p>
<p>Make sure your code's license is compatible with the license(s) of the
various components and libraries you use if applicable.</p>
<h4 id="description">description<a class="headerlink" href="#description" title="Permanent link">#</a></h4>
<p>Description of the analyzer. Please be concise and clear. The description is
 shown in the Cortex UI, TheHive and MISP.</p>
<h4 id="datatypelist">dataTypeList<a class="headerlink" href="#datatypelist" title="Permanent link">#</a></h4>
<p>The list of TheHive datatypes supported by the analyzer. Currently TheHive
accepts the following datatypes:</p>
<ul>
<li>domain</li>
<li>file</li>
<li>filename</li>
<li>fqdn</li>
<li>hash</li>
<li>ip</li>
<li>mail</li>
<li>mail_subject</li>
<li>other</li>
<li>regexp</li>
<li>registry</li>
<li>uri_path</li>
<li>url</li>
<li>user-agent</li>
</ul>
<p>If you need additional datatypes for your analyzer, please let us know at
<a href="mailto:support@thehive-project.org">support@thehive-project.org</a>.</p>
<h4 id="baseconfig">baseConfig<a class="headerlink" href="#baseconfig" title="Permanent link">#</a></h4>
<p>Name used to group configuration items common to several analyzer. This
prevent the user to enter the same API key for all analyzer flavors.
The Cortex analyzer config page group configuration items by their <code>baseConfig</code>.  </p>
<h4 id="config">config<a class="headerlink" href="#config" title="Permanent link">#</a></h4>
<p>Configuration dedicated to the analyzer's flavor. This is where we
 typically specify the TLP level of observables allowed to be analyzed with the
 <code>check_tlp</code> and <code>max_tlp</code> parameters. For example, if <code>max_tlp</code> is set to <code>2</code> (TLP:AMBER),
 TLP:RED observables cannot be analyzed.</p>
<h5 id="max_tlp">max_tlp<a class="headerlink" href="#max_tlp" title="Permanent link">#</a></h5>
<p>The TLP level above which the analyzer must not be executed.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">TLP</th>
<th style="text-align: center;">max_tlp value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Unknown</td>
<td style="text-align: center;">-1</td>
</tr>
<tr>
<td style="text-align: center;">WHITE</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">GREEN</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">AMBER</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: center;">RED</td>
<td style="text-align: center;">3</td>
</tr>
</tbody>
</table>
<h5 id="check_tlp">check_tlp<a class="headerlink" href="#check_tlp" title="Permanent link">#</a></h5>
<p>This is a boolean parameter. When <code>true</code>, <code>max_tlp</code> is checked. And if the
input's TLP is above <code>max_tlp</code>, the analyzer is not executed.</p>
<p>For consistency reasons, we do recommend setting both <code>check_tlp</code> and
<code>max_tlp</code> even if <code>check_tlp</code> is set to <code>false</code>.</p>
<h5 id="max_pap">max_pap<a class="headerlink" href="#max_pap" title="Permanent link">#</a></h5>
<p>The PAP level above which the analyzer must not be executed.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">TLP</th>
<th style="text-align: center;">max_tlp value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Unknown</td>
<td style="text-align: center;">-1</td>
</tr>
<tr>
<td style="text-align: center;">WHITE</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: center;">GREEN</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: center;">AMBER</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: center;">RED</td>
<td style="text-align: center;">3</td>
</tr>
</tbody>
</table>
<h5 id="check_pap">check_pap<a class="headerlink" href="#check_pap" title="Permanent link">#</a></h5>
<p>This is a boolean parameter. When <code>true</code>, <code>max_pap</code> is checked. And if the
input's PAP is above <code>max_pap</code>, the analyzer is not executed.</p>
<p>For consistency reasons, we do recommend setting both <code>check_pap</code> and
<code>max_pap</code> even if <code>check_pap</code> is set to <code>false</code>.</p>
<h5 id="command">command<a class="headerlink" href="#command" title="Permanent link">#</a></h5>
<p>The command used to run the analyzer. That's typically the full, absolute
path to the main program file.</p>
<h4 id="configurationitems">configurationItems<a class="headerlink" href="#configurationitems" title="Permanent link">#</a></h4>
<p>The list of configurationItems is necessary in order to be able to set all configuration variables for analyzers directly in the Cortex 2 user interface. As in the VirusTotal example above can be seen, every item is a json object that defines:
- name (string)
- description (string)
- type (string)
- multi (boolean)
- required (boolean)
- defaultValue (according to type, optional)</p>
<p>The <code>multi</code> parameter allows to pass a list as configuration variable instead of a single string or number. This is used e.g. in the MISP analyzer that queries multiple servers in one run and needs different parameters for that.</p>
<h3 id="output">Output<a class="headerlink" href="#output" title="Permanent link">#</a></h3>
<p>The output of an analyzer depends on the success or failure of its execution.</p>
<p>If the analyzer <strong>fails</strong> to execute:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;errorMessage&quot;</span><span class="p">:</span><span class="s2">&quot;..&quot;</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>When <code>success</code> is set to <code>false</code>, it indicates that something went wrong
    during the execution.</li>
<li><code>errorMessage</code> is free text - typically the error output message.</li>
</ul>
<p>If the analyzer <strong>succeeds</strong> (i.e. it runs without any error):</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;artifacts&quot;</span><span class="p">:[</span><span class="err">..</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;summary&quot;</span><span class="p">:{</span>
<span class="w">        </span><span class="nt">&quot;taxonomies&quot;</span><span class="p">:[</span><span class="err">..</span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;full&quot;</span><span class="p">:{</span><span class="err">..</span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li>When <code>success</code> is set to <code>true</code>, it indicates that the analyzer ran
    successfully.</li>
<li><code>artifacts</code> is a list of indicators extracted from the produced report.</li>
<li><code>full</code> is the full report of the analyzer. It is free form, as long
as it is JSON formatted.</li>
<li>
<p><code>summary</code> is used in TheHive for short reports displayed in the
    observable list and in the detailed page of each observable. It
    contains a list of taxonomies.</p>
<ul>
<li><code>taxonomies</code>:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;taxonomies&quot;</span><span class="p">:[</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NAME&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;predicate&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PREDICATE&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;\&quot;VALUE\&quot;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="s2">&quot;info&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">]</span>
</code></pre></div>
<ul>
<li><code>namespace</code> and <code>predicate</code> are free values but they should be as
 concise as possible. For example, the VirusTotal analyzer uses <em>VT</em>
 as a namespace and <em>Score</em> as a predicate.</li>
<li><code>level</code> intends to convey the maliciousness of the result:
    :<ul>
<li><code>info</code> : the analyzer produced an information, and the
    short report is shown in blue color in TheHive.</li>
<li><code>safe</code> : the analyzer did not find anything suspicious
    or the analyzed observable is safe according to
    the analyzer. TheHive displays the short report in green
    color.</li>
<li><code>suspicious</code> : the analyzer found that the observable is
    either suspicious or warrants further investigation. The
    short report has an orange color in TheHive.</li>
<li><code>malicious</code> : the analyzer found that the observable
    is malicious. The short report is red colored in TheHive.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>For more information refer to <a href="https://blog.thehive-project.org/2017/07/05/all-fresh-cortexutils-new-cortex-analyzers/">our blog</a>.</p>
<h3 id="the-cortexutils-python-library">The Cortexutils Python Library<a class="headerlink" href="#the-cortexutils-python-library" title="Permanent link">#</a></h3>
<p>So far, all the published analyzers have been written in Python. We
released a special Python library called <code>cortexutils</code> to help developers easily write their programs. Note though that Python is not mandatory for analyzer coding and any language that runs on Linux can be used, though you won't have the benefits of the CortexUtils library.</p>
<p>Cortexutils can be used with Python 2 and 3.
To install it :</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>cortexutils
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>cortexutils
</code></pre></div>
<p>This library is already used by all the analyzers published in our <a href="https://github.com/TheHive-Project/Cortex-Analyzers">Github
repository</a>. Feel free to
start reading the code of some of them before writing your own.</p>
<h3 id="report-templates">Report Templates<a class="headerlink" href="#report-templates" title="Permanent link">#</a></h3>
<p>When using TheHive, analysts can submit an observable for analysis to one or
several Cortex instances by a click of a button. Once finished,
Cortex returns the result to TheHive. The TheHive displays that result
using HTML templates for short and long reports.</p>
<h4 id="cortex-result-in-thehive">Cortex Result in TheHive<a class="headerlink" href="#cortex-result-in-thehive" title="Permanent link">#</a></h4>
<p>TheHive receives the Cortex result which is simply the JSON formatted
analyzer output described above:</p>
<ul>
<li>The <code>summary</code> section is read to display short reports in the observables
list and in the detailed observable page. This is stored in a <strong>dict</strong> object
named <code>content</code> within TheHive.</li>
<li>The <code>full</code> section is read to display long reports when clicking the short
    report in the observable list or when accessing a detailed observable
    page. In TheHive application, it is stored in a <strong>dict</strong> object named
    <code>content</code>.</li>
</ul>
<h4 id="displayed-information">Displayed Information<a class="headerlink" href="#displayed-information" title="Permanent link">#</a></h4>
<h5 id="when-no-template-is-imported">When No Template is Imported<a class="headerlink" href="#when-no-template-is-imported" title="Permanent link">#</a></h5>
<p>In the event that the analyzer report templates are not imported in TheHive
(only administrators can do such an operation via the <em>Admin &gt; Report
Templates</em> menu):</p>
<ul>
<li>In the observable list, TheHive is able to display the analyzer <code>summary</code>
    results using a builtin style sheet associated with the previously
    described taxonomy.</li>
<li>In the detailed observable page:<ul>
<li>the <code>full</code> result is displayed in raw format (the JSON output from
  Cortex)</li>
<li>the <code>summary</code> result is <strong>not displayed</strong>.</li>
</ul>
</li>
</ul>
<h5 id="when-templates-are-imported">When Templates are Imported<a class="headerlink" href="#when-templates-are-imported" title="Permanent link">#</a></h5>
<p>If templates are imported into TheHive:</p>
<ul>
<li>Short reports are displayed in the observable list and in the detailed
observable page.</li>
</ul>
<p><img alt="VT short report" src="../images/sc-short-vt.png" /></p>
<ul>
<li>Long reports are displayed when clicking on the short reports or in the
detailed observable page.</li>
</ul>
<p><img alt="VT long report" src="../images/sc-long-vt.jpg" /></p>
<h4 id="writing-templates">Writing Templates<a class="headerlink" href="#writing-templates" title="Permanent link">#</a></h4>
<p>To display results nicely in TheHive, write two HTML templates:</p>
<ul>
<li>One for short reports</li>
<li>One for long reports</li>
</ul>
<p>When TheHive users import them in the application, they will be definitely
more efficient at reading the analyzer reports and do their job accordingly.</p>
<p>If the analyzer is made of different flavors (i.e. has different service
interaction files with a <code>json</code> extension), you should provide two HTML
templates (short and long reports) for each flavor.</p>
<p>For example, the VirusTotal analyzer comes in two flavors hence it has 4 HTML
 templates:</p>
<div class="highlight"><pre><span></span><code>thehive-templates/VirusTotal_GetReport_3_0
<span class="p">|</span>--<span class="w"> </span>long.html
<span class="sb">`</span>--<span class="w"> </span>short.html
thehive-templates/VirusTotal_Scan_3_0
<span class="p">|</span>--<span class="w"> </span>long.html
<span class="sb">`</span>--<span class="w"> </span>short.html
</code></pre></div>
<p>The folder's name is the concatenation of the <code>name</code> and the
<code>version</code> values found in the service interaction files.</p>
<p>TheHive uses Bootstrap and AngularJS so you can leverage them in your
templates.</p>
<h5 id="short-report-templates-shorthtml">Short Report Templates (short.html)<a class="headerlink" href="#short-report-templates-shorthtml" title="Permanent link">#</a></h5>
<p>The short report uses taxonomies and is built into the analyzers by the
<code>summary()</code> function. Report templates read it as shown in the example below:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;label&quot;</span> <span class="na">ng-repeat</span><span class="o">=</span><span class="s">&quot;t in content.taxonomies&quot;</span>
  <span class="na">ng-class</span><span class="o">=</span><span class="s">&quot;{&#39;info&#39;: &#39;label-info&#39;, &#39;safe&#39;: &#39;label-success&#39;,</span>
<span class="s">  &#39;suspicious&#39;: &#39;label-warning&#39;,</span>
<span class="s">  &#39;malicious&#39;:&#39;label-danger&#39;}[t.level]&quot;</span><span class="p">&gt;</span>
    {{t.namespace}}:{{t.predicate}}={{t.value}}
<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</code></pre></div>
<p>If you want to change or add the information displayed in the short report in
the detailed observable page, you have to update the
<code>summary()</code> function in the analyzer's program and edit short.html as
well. Basically, copy the code in your short.html template and it will
do the job.</p>
<h5 id="long-report-templates-longhtml">Long Report Templates (long.html)<a class="headerlink" href="#long-report-templates-longhtml" title="Permanent link">#</a></h5>
<p>Long report templates are more or less free form as long as it reads the
content of the relevant section in the Cortex result (<code>full</code>). Feel
free to check what has already been written for existing analyzers to write
yours.</p>
<p>A good start can be:</p>
<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- Success --&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;panel panel-danger&quot;</span> <span class="na">ng-if</span><span class="o">=</span><span class="s">&quot;success&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;panel-heading&quot;</span><span class="p">&gt;</span>
        ANALYZERNAME Report
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;panel-body&quot;</span><span class="p">&gt;</span>
        [...]                      <span class="err">&lt;</span>= code here
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="cm">&lt;!-- General error  --&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;panel panel-danger&quot;</span> <span class="na">ng-if</span><span class="o">=</span><span class="s">&quot;!success&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;panel-heading&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>{{(artifact.data || artifact.attachment.name) | fang}}<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;panel-body&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">dl</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dl-horizontal&quot;</span> <span class="na">ng-if</span><span class="o">=</span><span class="s">&quot;content.errorMessage&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">dt</span><span class="p">&gt;&lt;</span><span class="nt">i</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;fa fa-warning&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">i</span><span class="p">&gt;</span> ANALYZERNAME: <span class="p">&lt;/</span><span class="nt">dt</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">dd</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;wrap&quot;</span><span class="p">&gt;</span>{{content.errorMessage}}<span class="p">&lt;/</span><span class="nt">dd</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">dl</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
<h2 id="submitting-an-analyzer">Submitting an Analyzer<a class="headerlink" href="#submitting-an-analyzer" title="Permanent link">#</a></h2>
<p>We <strong>highly encourage you to share your analyzers</strong> with the community through our Github repository. To do so, we invite you to follow a few steps before submitting a pull request.</p>
<h3 id="check-existing-issues">Check Existing Issues<a class="headerlink" href="#check-existing-issues" title="Permanent link">#</a></h3>
<p>Start by checking <a href="https://github.com/TheHive-Project/Cortex-Analyzers/issues?utf8=%E2%9C%93&amp;q=is%3Aissue%20is%3Aopen%20label%3A%22feature%20request%22%20label%3Aanalyzer">if an issue already exists</a> for the analyzer you'd like to write and contribute. Verify that nobody is working on it. If an issue exists and has the <strong>in progress</strong>, <strong>under review</strong> or <strong>pr-submitted</strong> label, it means somebody is already working on the code or has finished it.</p>
<p>If you are short on ideas, check issues with a <a href="https://github.com/TheHive-Project/Cortex-Analyzers/issues?utf8=%E2%9C%93&amp;q=is%3Aissue%20is%3Aopen%20label%3A%22help%20wanted%22"><strong>help wanted</strong> label</a>. If one of those issues interest you, indicate that you are working on it.</p>
<h3 id="open-an-issue">Open an Issue<a class="headerlink" href="#open-an-issue" title="Permanent link">#</a></h3>
<p>If there's no issue open for the analyzer you'd like to contribute, <a href="https://github.com/TheHive-Project/Cortex-Analyzers/issues/new">open one</a>. Indicate that you are working on it to avoid having someone start coding it.</p>
<p>You have to create an issue for each analyzer you'd like to submit.</p>
<h3 id="review-your-service-interaction-files">Review your Service Interaction File(s)<a class="headerlink" href="#review-your-service-interaction-files" title="Permanent link">#</a></h3>
<p>Review your service interaction files. For example, let's check the
VirusTotal JSON analyzer configuration file(s):</p>
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VirusTotal_GetReport&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3.0&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;author&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CERT-BDF&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://github.com/TheHive-Project/Cortex-Analyzers&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;license&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AGPL-V3&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Get the latest VirusTotal report for a file, hash, domain or an IP address&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;dataTypeList&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;hash&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;domain&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ip&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;baseConfig&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VirusTotal&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;check_tlp&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;max_tlp&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;service&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;get&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;VirusTotal/virustotal.py&quot;</span>
<span class="p">}</span>
</code></pre></div>
Ensure that all information is correct and particularly the <code>author</code> and
<code>license</code> parameters.</p>
<h3 id="provide-the-list-of-requirements">Provide the List of Requirements<a class="headerlink" href="#provide-the-list-of-requirements" title="Permanent link">#</a></h3>
<p>If your analyzer is written in Python, make sure to complete the
<code>requirements.txt</code> file with the list of all the external libraries that are
needed to run the analyzer correctly.</p>
<h3 id="check-the-taxonomy">Check the Taxonomy<a class="headerlink" href="#check-the-taxonomy" title="Permanent link">#</a></h3>
<p>We chose to use a formatted summary report to match a taxonomy as
described above. If you want your analyzer reports in the observable lists,
ensure that your summary matches this format. If your analyzer is
written in Python and you are using our <code>cortexutils</code> library,
you can use the <code>summary()</code>and <code>build_taxonomy()</code> functions.</p>
<h3 id="provide-global-configuration-parameters">Provide Global Configuration Parameters<a class="headerlink" href="#provide-global-configuration-parameters" title="Permanent link">#</a></h3>
<p>When submitting your analyzer, please provide the necessary global
configuration in <code>/etc/cortex/application.conf</code> if needed. You can provide this information in a <code>README</code> file.</p>
<h3 id="verify-execution">Verify Execution<a class="headerlink" href="#verify-execution" title="Permanent link">#</a></h3>
<p>Use these three simple checks before submtting your analyzer:</p>
<ul>
<li>Ensure it works with the expected configuration, TLP or dataType.</li>
<li>Ensure it works with missing configuration, dataType or TLP: your
analyzer must generate an explicit error message.</li>
<li>Ensure the long report template handles error messages correctly.</li>
</ul>
<h3 id="create-a-pull-request">Create a Pull Request<a class="headerlink" href="#create-a-pull-request" title="Permanent link">#</a></h3>
<p>Create one Pull Request per analyzer against the <strong>develop</strong> branch of the
<a href="https://github.com/TheHive-Project/Cortex-Analyzers/">Cortex-Analyzers</a> repository. Reference the issue you've created in your PR.</p>
<p>We have to review your analyzers. Distinct PRs will allow us to review them
more quickly and release them to the benefit of the whole community.</p>
<h2 id="need-help">Need Help?<a class="headerlink" href="#need-help" title="Permanent link">#</a></h2>
<p>Something does not work as expected? No worries, we got you covered. Please
join our <a href="https://groups.google.com/a/thehive-project.org/forum/#!forum/users">user forum</a>,
 contact us on <a href="https://gitter.im/TheHive-Project/TheHive">Gitter</a>, or send us
 an email at <a href="mailto:support@thehive-project
 .org">support@thehive-project.org</a>. We are here to help.</p>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">September 5, 2022 12:21:12</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.strangebee.com" target="_blank" rel="noopener" title="www.strangebee.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40h-16c-1.1 0-2.2 0-3.3-.1-1.4.1-2.8.1-4.2.1H392c-22.1 0-40-17.9-40-40v-88c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v88c0 22.1-17.9 40-40 40h-55.9c-1.5 0-3-.1-4.5-.2-1.2.1-2.4.2-3.6.2h-16c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9.1-2.8v-69.6H32c-18 0-32-14-32-32.1 0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7l255.4 224.5c8 7 12 15 11 24z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://blog.strangebee.com" target="_blank" rel="noopener" title="blog.strangebee.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="m61.7 169.4 101.5 278C92.2 413 43.3 340.2 43.3 256c0-30.9 6.6-60.1 18.4-86.6zm337.9 75.9c0-26.3-9.4-44.5-17.5-58.7-10.8-17.5-20.9-32.4-20.9-49.9 0-19.6 14.8-37.8 35.7-37.8.9 0 1.8.1 2.8.2-37.9-34.7-88.3-55.9-143.7-55.9-74.3 0-139.7 38.1-177.8 95.9 5 .2 9.7.3 13.7.3 22.2 0 56.7-2.7 56.7-2.7 11.5-.7 12.8 16.2 1.4 17.5 0 0-11.5 1.3-24.3 2l77.5 230.4L249.8 247l-33.1-90.8c-11.5-.7-22.3-2-22.3-2-11.5-.7-10.1-18.2 1.3-17.5 0 0 35.1 2.7 56 2.7 22.2 0 56.7-2.7 56.7-2.7 11.5-.7 12.8 16.2 1.4 17.5 0 0-11.5 1.3-24.3 2l76.9 228.7 21.2-70.9c9-29.4 16-50.5 16-68.7zm-139.9 29.3-63.8 185.5c19.1 5.6 39.2 8.7 60.1 8.7 24.8 0 48.5-4.3 70.6-12.1-.6-.9-1.1-1.9-1.5-2.9l-65.4-179.2zm183-120.7c.9 6.8 1.4 14 1.4 21.9 0 21.6-4 45.8-16.2 76.2l-65 187.9C426.2 403 468.7 334.5 468.7 256c0-37-9.4-71.8-26-102.1zM504 256c0 136.8-111.3 248-248 248C119.2 504 8 392.7 8 256 8 119.2 119.2 8 256 8c136.7 0 248 111.2 248 248zm-11.4 0c0-130.5-106.2-236.6-236.6-236.6C125.5 19.4 19.4 125.5 19.4 256S125.6 492.6 256 492.6c130.5 0 236.6-106.1 236.6-236.6z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://chat.thehive-project.org" target="_blank" rel="noopener" title="chat.thehive-project.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["header.autohide", "navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes"], "search": "../../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>